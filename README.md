# レシピ管理アプリ 🍳

飲食業向けの高機能なレシピ・原価管理システム。オリジナルレシピ、在庫管理、仕込みカレンダー、発注システムを統合管理できます。
PCからスマートフォンまで、あらゆるデバイスで快適に利用できるように最適化されています。

## ✨ 全機能一覧

### 1. レシピ管理機能

#### 複数の入力モード
- **通常モード**: 一般的な料理のレシピ登録に対応
  - 材料名、分量、単位、単価を柔軟に入力
  - 仕入れマスタと連携し自動原価計算
  - 複数の手順・調理方法を記録可能

- **パン (Baker's %)モード**: ベーカーズパーセント対応の専門的な入力モード
  - 粉類を100%基準に設定
  - その他の材料を粉に対するパーセンテージで管理
  - 加水率、塩分率などを自動計算
  - パン職人向けの高度な管理が可能

#### レシピの整理と共有
- **ドラッグ＆ドロップ並び替え**: PC・スマートフォン両対応
  - PC: マウスドラッグで直感的に移動
  - スマートフォン: 1秒間長押しでドラッグモード起動（誤操作防止）
- **タグ・カテゴリ管理**: 「メイン」「デザート」「サラダ」など自由に分類
- **画像登録**: 完成写真で視覚的に管理
- **オリジナルレシピ保護**: シェフによる独自レシピの著作権管理

#### 多言語対応
- **自動翻訳機能**: レシピを以下の言語に自動翻訳
  - 日本語（デフォルト）
  - 英語
  - フランス語
  - イタリア語
- 多国籍スタッフ対応やレシピの国際共有が可能

#### 閲覧履歴と最適化
- **最近見たレシピ**: 頻繁に使うレシピにワンクリックアクセス
- **削除と復元**: 削除したレシピは一度ゴミ箱に入り、いつでも復元可能

---

### 2. 原価管理機能

#### 自動原価計算
- **材料単価の管理**: 各材料の仕入れ価格を登録
- **即座の原価算出**: 材料と分量から自動的に原価を計算
- **原価シミュレーター**: 売上予想額から粗利を自動計算
  - 原価、販売価格、粗利益を同時表示
  - 複数商品の利益分析に対応

#### 仕入れマスタ管理
- **材料データベース**: よく使う材料を事前登録
  - 材料名、単位、仕入れ先、単価を一元管理
  - CSVでの一括登録・更新に対応
- **複数単位対応**: 同じ材料を複数の単位（kg, g, 個など）で管理
- **単位自動変換**: レシピと在庫の異なる単位を自動換算

#### 粗利益分析
- **粗利表示**: 売上予想額と原価から粗利を自動計算
- **コスト削減ポイント**: 原価が高い材料を可視化
- **複数レシピの比較**: 複数のレシピの利益率を比較分析

---

### 3. 在庫管理機能

#### リアルタイム在庫追跡
- **入出庫記録**: 材料の仕入れ・使用を自動記録
- **在庫推移管理**: 時系列で在庫の増減を追跡
- **自動アラート**: 在庫が低下時に警告表示

#### 棚卸し機能
- **定期的な在庫確認**: 棚卸しスナップショットを記録
- **差異レポート**: システム上の在庫と実際の差異を表示
- **差異分析**: 原因追跡と改善提案

#### CSV一括インポート
- **複数材料の一括登録**: CSVファイルから大量データを効率的に登録
- **フォーマット自動判定**: 異なるフォーマットに自動対応
- **エラーハンドリング**: 問題のある行を特定して対処

#### 在庫ダッシュボード
- **一覧表示**: 全材料の現在の在庫を一覧表示
- **検索フィルタ**: カテゴリ・タグで在庫を絞り込み
- **グラフ表示**: 在庫推移をグラフで視覚化（オプション）

---

### 4. 仕込みカレンダー & 発注管理

#### 仕込みカレンダー
- **製造予定管理**: レシピごとの製造予定を日単位で登録
- **カレンダービュー**: 月単位で製造予定を可視化
- **複数レシピの同時管理**: 複数のレシピを同日に管理可能
- **オーバーワーク警告**: 1日の製造量が多すぎる場合に警告

#### 発注リスト自動生成
- **必要材料の自動計算**: 製造予定から必要な材料を自動計算
  - 複数レシピの材料を統合
  - 既存在庫を差し引き
- **2割ルール**: 材料の発注量を自動計算（カスタマイズ可能）
- **発注数量の自動調整**: ロット単位での最適な発注量を提案

#### 発注履歴と分析
- **発注履歴の記録**: すべての発注データを自動保存
- **推移分析**: 過去の発注パターンから傾向を分析
- **仕入れ先ごとの比較**: 複数の仕入れ先の価格・品質を比較

---

### 5. データ管理機能

#### インポート・エクスポート
- **JSONバックアップ**: レシピ全体をJSONファイルとしてダウンロード
- **JSON復元**: バックアップファイルから完全に復元
- **CSVインポート**: 仕入れ先やマスターデータをCSVから一括登録

#### Web・画像からのインポート
- **Web取り込み**: Webページからレシピ情報を自動抽出
  - レシピタイトル、材料、手順を自動抽出
  - 複数フォーマットのレシピに対応
- **画像取り込み**: レシピ写真から材料情報を抽出（OCR対応）

#### 単位カスタマイズ
- **CSV単位オーバーライド**: CSVファイルからカスタム単位を登録
  - 独自の単位（箱、ケース、パッケージ等）を定義
  - レシピ・在庫・発注で統一利用

---

### 6. 高度な検索・フィルタ機能

#### マルチ条件フィルタ
- **店舗フィルタ**: 複数店舗を管理している場合、店舗ごとにフィルタ
- **カテゴリフィルタ**: 「メイン」「デザート」など任意のカテゴリで絞り込み
- **タグフィルタ**: 複数のタグを組み合わせて検索
- **複合検索**: 複数条件を組み合わせた高度な検索

#### 高速材料検索
- **オートコンプリート**: 材料名を入力中にリアルタイム候補表示
- **データベースレベル最適化**: RPC関数で高速検索を実現
- **複数マッチング**: 材料名の曖昧マッチにも対応

#### 最近見たレシピ
- **自動記録**: ユーザーが閲覧したレシピを自動記録
- **ワンクリックアクセス**: 頻繁に使うレシピに素早くアクセス
- **プライベート機能**: 各ユーザーの閲覧履歴は独立して管理

---

### 7. ユーザー管理 & 権限設定

#### ロールベースのアクセス制御
- **一般スタッフ**: レシピ閲覧、仕込み履歴参照、簡易編集
- **管理者**: ユーザー管理、全体データ監視、権限設定、全機能アクセス
- **シェフ**: レシピ作成・編集・共有、オリジナルレシピ保護

#### ユーザー管理画面
- **ユーザー一覧**: 登録済みユーザー一覧を表示
- **ロール管理**: ユーザーのロールを動的に変更
- **アカウント有効化**: ユーザーアカウントの有効・無効を管理

#### チーム管理
- **複数スタッフ対応**: チーム全体でレシピを共有
- **権限分離**: ユーザーごとに表示可能なデータを制限
- **監査ログ**: ユーザーのアクションを自動記録（オプション）

---

### 8. 調理モード機能

#### リアルタイム調理サポート
- **調理画面**: 材料表示を調理台での見やすさを優先
- **フォントサイズ**: 調理中でも読みやすい大きめフォント
- **チェックリスト**: 調理ステップを1つずつチェック
- **タイマー**: 各ステップの調理時間をタイマー表示（オプション）

#### 印刷機能
- **レシピ印刷**: レイアウトを自動調整して美しく印刷
- **調理用フォーマット**: 調理現場での利用を想定した印刷レイアウト

---

### 9. データインポート & CSV管理

#### CSVからのマスターデータ登録
- **仕入れマスター登録**: 仕入れ先データをCSV形式で一括登録
  - 材料名、単価、単位、仕入れ先を一括入力
  - エラー行を特定して修正可能
- **在庫スナップショット**: 棚卸し結果をCSV形式で取り込み

#### CSV単位オーバーライド機能
- **カスタム単位定義**: 「ケース」「ボックス」など独自単位を定義
- **複数単位変換**: kg ↔ ケース ↔ 個 など複数単位の自動変換

---

### 10. 通知とアラート機能

#### トースト通知
- **操作確認**: レシピ保存、削除などの操作完了を通知
- **エラー表示**: 不正な入力やシステムエラーを表示
- **成功メッセージ**: 正常完了時に確認メッセージを表示

#### システムアラート
- **在庫不足警告**: 在庫が少なくなった場合に警告
- **原価超過警告**: 設定原価を超えた場合に警告
- **権限エラー**: 権限のない操作をした場合に通知

---

### 11. 認証 & セキュリティ

#### ユーザー認証
- **メール・パスワード認証**: Supabase Authによる安全な認証
- **パスワードリセット**: 忘れたパスワードをメールで復旧
- **セッション管理**: 自動ログアウト機能

#### セキュリティ機能
- **RLS (Row-Level Security)**: PostgreSQLレベルでのアクセス制御
- **データ暗号化**: Supabaseによる暗号化通信
- **権限分離**: ユーザーごとに見られるデータを制限

---

### 12. パフォーマンス最適化機能

#### 高速ロード
- **並列データフェッチ**: 認証と食材データを並列処理
- **スマートキャッシング**: クエリ結果をメモリに保存
- **遅延ロード**: 画像を必要な時だけ読み込み

#### モバイル最適化
- **レスポンシブデザイン**: PC・タブレット・スマートフォン自動対応
- **軽量なUIコンポーネント**: モバイルでの高速表示
- **タッチジェスチャー**: スマートフォンでの直感的操作

---

### 13. レイアウト & UI

#### PC版レイアウト
- **3カラムレイアウト**: レシピ一覧 / 詳細 / 編集を同時表示
- **効率的な操作**: マウス操作で素早く切り替え

#### スマートフォン版レイアウト
- **単列レイアウト**: スマートフォン画面に最適化
- **スワイプ操作**: 左右スワイプでページ切り替え
- **ボタン配置**: 片手操作を優先

#### タブレット版レイアウト
- **2カラムレイアウト**: 一覧と詳細を並べて表示
- **PC同等の機能**: PC版と同等の全機能を利用可能

## 📱 詳細な使い方ガイド

### 1. 初めてのセットアップ

#### ログイン
1. アプリにアクセス
2. メールアドレスとパスワードを入力
3. **「ログイン」** ボタンをクリック
4. ※初回は管理者にアカウント作成を依頼してください

#### 仕入れマスタの登録（管理者向け）
1. 右上メニュー → **`📊 データ管理`** を開く
2. **「仕入れマスタ」** タブをクリック
3. **「CSVからインポート」** または **「手動追加」** を選択
4. よく使う材料を登録：
   - 材料名（例：「小麦粉」）
   - 仕入れ単位（例：「kg」）
   - 仕入れ価格（例：「200円/kg」）
   - 仕入れ先（オプション）

#### ユーザーの追加（管理者向け）
1. 右上メニュー → **`👥 ユーザー管理`** を開く
2. **「新規ユーザー追加」** をクリック
3. メールアドレスを入力 → ユーザーに招待メールが送信される
4. ユーザーはメール内のリンクからパスワードを設定

---

### 2. レシピの登録方法

#### Step 1: レシピ作成画面を開く
1. 画面右上の **`+ レシピ追加`** ボタンをクリック
2. **「レシピモード選択」** ダイアログが表示される

#### Step 2: 入力モードを選択

**通常モードの場合:**
1. **「通常」** を選択 → **「作成」** をクリック
2. 以下の情報を入力：
   - レシピ名（例：「チョコレートケーキ」）
   - 説明（オプション）
   - カテゴリ（例：「デザート」）
   - タグ（複数選択可）

**パン (Baker's %)モードの場合:**
1. **「パン (Baker's %)」** を選択 → **「作成」** をクリック
2. 基準となる粉を100%で入力：
   - 材料名（例：「強力粉」）
   - 分量（例：「1000g」）
3. その他の材料をパーセンテージで入力：
   - 材料名と粉に対するパーセンテージ（例：「塩 2%」）
4. アプリが自動計算：
   - 加水率、塩分率
   - 実際の重量

#### Step 3: 材料を追加

1. **「材料を追加」** ボタンをクリック
2. 材料名を入力（仕入れマスタから自動補完）
3. 分量を入力
4. 単位を選択（kg, g, 個など）
5. 単価を入力（仕入れマスタに登録済みなら自動入力）
6. 右のボタンで並び替え・削除が可能

**原価の確認:**
- 入力完了すると、右側に **「原価合計」** が自動表示される
- 各材料の原価も同時に表示

#### Step 4: 調理手順を追加

1. **「調理手順」** タブをクリック
2. **「手順を追加」** ボタンをクリック
3. 各ステップの説明を入力（例：「小麦粉とベーキングパウダーを混ぜる」）
4. 所要時間（オプション）を入力

#### Step 5: 画像とメモを追加

1. **「画像」** タブから完成写真をアップロード
2. **「メモ」** タブからレシピに関する追加情報を記入

#### Step 6: レシピを保存

1. 画面下の **「保存」** ボタンをクリック
2. 「レシピを正常に保存しました」と表示されたら完了
3. ※パン (Baker's %)モードの場合、自動計算値を確認してから保存

---

### 3. レシピの検索・並び替え

#### レシピを検索する

1. **「レシピ一覧」** 画面の検索バーをクリック
2. レシピ名を入力
3. **「フィルタ条件」** ボタンで詳細検索：
   - カテゴリで絞り込み
   - タグで絞り込み
   - 店舗で絞り込み

#### レシピを並び替える

**PC版:**
1. レシピカードを左クリック
2. そのまままドラッグして目的の位置に移動
3. ドロップで並び替え完了

**スマートフォン版:**
1. レシピカードを1秒間長押し
2. ドラッグモードに自動切り替わる
3. 目的の位置に移動 → 指を離すと確定

---

### 4. レシピの編集・削除

#### レシピを編集する

1. レシピ一覧から対象レシピをクリック
2. **「編集」** ボタンをクリック
3. 必要な項目を修正
4. **「保存」** ボタンで確定

#### レシピを削除する

1. レシピ詳細画面で **「削除」** ボタンをクリック
2. 確認ダイアログで **「削除する」** をクリック
3. ※削除したレシピは **「ゴミ箱」** から復元可能

---

### 5. 原価計算・分析

#### 原価を確認する

1. レシピを開く
2. 右側に **「原価合計」** が表示される
3. 各材料の原価を確認可能

#### 原価シミュレーターで粗利を計算

1. レシピ詳細画面で **「原価シミュレーター」** ボタンをクリック
2. 以下を入力：
   - **販売価格**: 商品の売上予想額
   - **販売数量**（オプション）
3. 自動計算される内容：
   - 原価合計
   - 粗利益
   - 粗利率 (%)

#### 複数レシピの原価を比較

1. 右上メニュー → **`📊 データ管理`** を開く
2. **「原価分析」** タブをクリック
3. 複数レシピの原価・粗利を並べて表示

---

### 6. 在庫管理

#### 在庫を登録する

1. 右上メニュー → **`📊 データ管理`** を開く
2. **「在庫管理」** タブをクリック
3. **「新規在庫」** ボタンをクリック
4. 以下を入力：
   - 材料名
   - 現在の在庫量
   - 単位
5. **「保存」** をクリック

#### 在庫を更新する（入出庫）

1. **「在庫管理」** タブで対象材料を検索
2. **「編集」** ボタンをクリック
3. 入出庫を記録：
   - 入庫: 仕入れた分量を加算
   - 出庫: 使用した分量を減算
4. **「更新」** をクリック

#### 棚卸しを実施する

1. **「在庫管理」** タブで **「棚卸しを実施」** をクリック
2. 各材料の実際の在庫量を入力
3. システムと差異がある場合、警告が表示される
4. **「棚卸し確定」** をクリック

#### 在庫をCSVからインポート

1. **「在庫管理」** タブで **「CSVインポート」** をクリック
2. CSVファイルを選択（形式: 材料名, 在庫量, 単位）
3. プレビューで内容確認 → **「インポート」** をクリック

---

### 7. 仕込みカレンダー & 発注管理

#### 仕込み予定を登録する

1. 右上メニュー → **`📅 仕込みカレンダー`** を開く
2. カレンダーから日付を選択
3. **「レシピを追加」** ボタンをクリック
4. 以下を入力：
   - レシピ選択（検索から選択）
   - 製造数量（例：「10個」）
5. **「追加」** をクリック

#### 発注リストを自動生成

1. **「仕込みカレンダー」** で複数の仕込み予定を登録
2. **「発注リスト生成」** ボタンをクリック
3. システムが自動計算：
   - 必要な材料と分量
   - 現在の在庫との差引
   - 2割ルール（カスタマイズ可能）を適用した発注量
4. **「発注リストを表示」** ボタンで確認

#### 過去の発注履歴を確認

1. **「仕込みカレンダー」** 内の **「発注履歴」** タブをクリック
2. 過去の発注データを表示：
   - 発注日、材料、数量、金額
3. グラフで推移を分析可能（オプション）

---

### 8. データのバックアップ・復元

#### JSONバックアップを作成

1. 右上メニュー → **`📊 データ管理`** を開く
2. **「バックアップ」** タブをクリック
3. **「バックアップをダウンロード」** をクリック
4. `recipes_backup_20260203.json` などのファイルがダウンロードされる

#### バックアップから復元

1. **「バックアップ」** タブで **「バックアップをアップロード」** をクリック
2. JSONファイルを選択
3. **「復元」** をクリック
4. ※既存データは上書きされるため、事前にバックアップを取得してください

---

### 9. 調理モード

#### 調理画面を起動

1. レシピ詳細画面で **「調理モード」** ボタンをクリック
2. 材料と手順が調理台での見やすさを優先したレイアウトで表示

#### 調理中の操作

- **材料をチェック**: 各材料の横のチェックボックスをクリック
- **手順をチェック**: 各ステップの横のチェックボックスをクリック
- **フォントサイズ調整**: **「+」「-」** ボタントサイズ変更（スマートフォンで見やすく）
- **印刷**: **「印刷」** ボタンで調理用の紙に印刷

---

### 10. Web・画像からのインポート

#### Webページからレシピを取り込む

1. 右上メニュー → **`📊 データ管理`** を開く
2. **「インポート」** タブをクリック
3. **「Webから取り込む」** を選択
4. レシピWebサイトのURLを入力
5. **「取り込み」** をクリック
6. 自動抽出されたレシピを確認 → **「保存」** をクリック

#### 画像からレシピを取り込む

1. **「インポート」** タブで **「画像から取り込む」** を選択
2. レシピが写った画像をアップロード
3. OCRで材料・手順が自動抽出される
4. 抽出内容を確認・修正 → **「保存」** をクリック

---

### 11. 多言語対応

#### レシピを翻訳する

1. レシピ詳細画面で **「翻訳」** ボタンをクリック
2. 翻訳言語を選択：
   - 英語
   - フランス語
   - イタリア語
3. 自動翻訳されたレシピが表示される
4. 修正が必要な場合は手動で編集

---

### 12. ユーザーロール別の操作

#### 一般スタッフの操作

- レシピの閲覧
- 仕込み履歴の参照
- 在庫の照会
- 調理モードの利用

#### シェフの操作

- レシピの作成・編集
- オリジナルレシピの公開/非公開設定
- 多言語翻訳
- 他のユーザーとのレシピ共有

#### 管理者の操作

- すべての機能にアクセス可能
- ユーザー管理（追加・削除・ロール変更）
- 全体データの監視・分析
- システム設定（2割ルール、アラート等）

## 🚀 パフォーマンス最適化

### 最新の改善
- **並列データフェッチ**: 認証クエリと食材クエリを並列処理（初期ロード高速化）
- **スマートキャッシング**: リサイプルエピローグのクエリ結果をキャッシュ
- **データベースインデックス**: よく使われるカラムにインデックスを設定
- **懒延ロード**: 画像の遅延ロードで初期表示を軽量化
- **CSS最適化**: 競合スタイルを削除し、正規化
- **モバイルレスポンシブ改善**: スマートフォンのUI/UXを継続最適化

## 🛠 技術スタック

- **Frontend**: React 18, Vite
- **Styling**: Native CSS (Mobile First Design)
- **データベース**: Supabase (PostgreSQL + RLS)
- **認証**: Supabase Auth
- **ドラッグ&ドロップ**: @dnd-kit (Sortable, Core, Modifiers)
- **ストレージ**: Supabase Storage (CSV, 画像)
- **デプロイ**: GitHub Pages
- **バリデーション**: Zod
- **アイコン**: QR Code (react-qr-code)

## 🏗 システムアーキテクチャ

```
Frontend (React + Vite)
    ↓
REST API
    ↓
Supabase (PostgreSQL + RLS)
├─ 認証 (Auth)
├─ データベース
│  ├─ recipes (レシピ)
│  ├─ recipe_contents (材料)
│  ├─ recipe_steps (手順)
│  ├─ inventory_items (在庫)
│  ├─ recent_views (閲覧履歴)
│  └─ その他テーブル
└─ ストレージ (CSV, 画像)
```

## 💻 開発環境セットアップ

### 前提条件
- Node.js 16以上
- npm または yarn

### インストール手順

```bash
# リポジトリをクローン
git clone <repository-url>
cd app-main-22

# 依存パッケージをインストール
npm install

# 開発サーバーを起動
npm run dev
```

### ビルド

```bash
# 本番用にビルド
npm run build

# ビルド結果をプレビュー
npm run preview
```

## 🔧 トラブルシューティング

### ログイン・認証に関する問題

#### パスワードを忘れた場合
1. ログイン画面で **「パスワードをお忘れですか？」** をクリック
2. メールアドレスを入力
3. パスワード復旧メールが届く
4. メール内のリンクをクリックして新しいパスワードを設定

#### ログインできない
- **原因**: メールアドレスまたはパスワードが正しくない
- **解決方法**:
  1. メールアドレスの綴りを確認
  2. CapsLock（大文字ロック）がONになっていないか確認
  3. パスワード復旧から新しいパスワードを設定

#### アカウントが有効化されていない
- **原因**: 管理者がまだアカウントを作成していない
- **解決方法**: 管理者に連絡してアカウント作成を依頼してください

### レシピ・材料に関する問題

#### 材料の自動補完が出てこない
- **原因**: 仕入れマスタに該当材料が登録されていない
- **解決方法**:
  1. 右上メニュー → **`📊 データ管理`** を開く
  2. **「仕入れマスタ」** タブから材料を追加
  3. 追加後、再度レシピ作成画面で検索

#### レシピの保存に失敗する
- **原因**: ネット接続が不安定、または必須項目が未入力
- **解決方法**:
  1. 必須項目（レシピ名、材料）を確認
  2. ネット接続状況を確認
  3. ブラウザの再読み込みを試す

#### 原価が計算されない
- **原因**: 材料の単価が登録されていない
- **解決方法**:
  1. 仕入れマスタで材料に単価を追加
  2. レシピ作成時に材料の単価を直接入力

#### パン (Baker's %)モードの自動計算が間違っている
- **原因**: 基準となる粉の分量が100%になっていない
- **解決方法**:
  1. レシピ編集画面を開く
  2. 基準となる粉の分量を確認（必ず100%）
  3. 他の材料をパーセンテージで再入力

### 在庫管理に関する問題

#### 在庫が正しく反映されない
- **原因**: 出庫記録が正確に反映されていない
- **解決方法**:
  1. **「在庫管理」** タブで当該材料を検索
  2. **「編集履歴」** を確認して誤った出庫を修正
  3. 棚卸しを実施して実在庫と照合

#### 棚卸し結果に差異がある
- **原因**: システム上の在庫と実在庫にズレが発生
- **解決方法**:
  1. **「在庫管理」** で当該材料の履歴を確認
  2. 誤った出庫記録を修正
  3. 棚卸し差異の原因を調査（破損・盗難など）

#### CSVインポートでエラーが出る
- **原因**: CSVファイルの形式が正しくない
- **解決方法**:
  1. CSVファイルの列順を確認：[材料名, 在庫量, 単位]
  2. 文字エンコーディングがUTF-8であることを確認
  3. 空行や余分な空白を削除

### 仕込みカレンダー・発注に関する問題

#### 発注リストが生成されない
- **原因**: 仕込み予定が登録されていない、または在庫量が0
- **解決方法**:
  1. **「仕込みカレンダー」** で複数の仕込み予定を登録
  2. 各材料の在庫量が正しく入力されているか確認
  3. **「発注リスト生成」** を再度クリック

#### 2割ルールの計算結果がおかしい
- **原因**: カスタム設定が反映されていない
- **解決方法**:
  1. 右上メニュー → **`⚙️ システム設定`** を開く（管理者権限が必要）
  2. **「2割ルール」** の設定値を確認
  3. 設定を修正後、発注リストを再生成

### パフォーマンスに関する問題

#### アプリが遅い・重い
- **原因**: ブラウザのキャッシュが古い、またはメモリ不足
- **解決方法**:
  1. ブラウザを再起動
  2. ブラウザのキャッシュをクリア（Ctrl+Shift+Delete / Cmd+Shift+Delete）
  3. 他のタブ・アプリを閉じてメモリを解放

#### 画像がアップロードできない
- **原因**: ファイルサイズが大きすぎる、またはフォーマットが非対応
- **解決方法**:
  1. サポートされるフォーマット: JPG, PNG
  2. ファイルサイズを5MB以下に圧縮
  3. 画像編集ツールで解像度を下げて再度試す

#### ページの読み込みが遅い
- **原因**: ネット接続が遅い、またはサーバーが混雑
- **解決方法**:
  1. ネット接続を確認
  2. Wi-Fiに接続（特にスマートフォン）
  3. 別の時間帯に再度試す

### データ・バックアップに関する問題

#### バックアップファイルが破損している
- **原因**: ダウンロード途中で中断、またはファイルが改変された
- **解決方法**:
  1. 再度バックアップを作成
  2. ダウンロード完了まで待つ
  3. ファイルを移動・リネームしない

#### 復元に失敗する
- **原因**: JSONフォーマットが正しくない、またはバージョンが異なる
- **解決方法**:
  1. バックアップファイルを正しく選択
  2. 古いバージョンのバックアップを試す
  3. サポートに連絡

---

## ❓ よくある質問 (FAQ)

### 一般的な質問

**Q: このアプリは無料ですか？**
A: はい、飲食店向けの自社利用を想定した無料ツールです。

**Q: 複数の店舗でレシピを共有できますか？**
A: はい、権限設定で複数店舗のスタッフを登録し、店舗ごとのレシピを共有できます。

**Q: モバイルで利用できますか？**
A: はい、スマートフォン・タブレットに完全対応しています。ブラウザからアクセスするだけで使用可能です。

**Q: オフラインで使用できますか？**
A: いいえ、インターネット接続が必要です。ただし、キャッシング機能により一度読み込んだデータは多少のオフライン状態でも表示可能です。

---

### レシピ管理について

**Q: Baker's %モードと通常モードの違いは何ですか？**
A: Baker's %モードはパン作り専用で、粉を100%基準に分量をパーセンテージで管理します。通常モードは一般的な料理用で、グラムや個数で自由に分量を入力できます。

**Q: レシピを複製できますか？**
A: はい、レシピ詳細画面で **「複製」** ボタンをクリックすることで、既存レシピを元に新しいレシピを作成できます。

**Q: 複数ユーザーで同時にレシピを編集できますか？**
A: いいえ、1つのレシピは1ユーザーのみ編集可能です。編集完了後、他ユーザーが閲覧・編集できます。

**Q: 削除したレシピは完全に消えますか？**
A: いいえ、削除後も30日間ゴミ箱に保存されます。その間は復元可能です。30日経過後に自動削除されます。

---

### 原価管理について

**Q: 原価に仕入れ手数料を含めることはできますか？**
A: はい、仕入れマスタで 単価に手数料を含めて登録することで対応できます。

**Q: 複数の仕入れ先から同じ材料を購入する場合、どうしたらいいですか？**
A: 仕入れ先ごとに異なる材料として登録することをお勧めします。例えば「小麦粉（A社）」「小麦粉（B社）」のように区別します。

**Q: 原価シミュレーターで複数の販売価格を試したいのですが？**
A: シミュレーター画面で販売価格を変更するたびに自動計算されるため、複数の価格設定を試験的に入力できます。

**Q: 季節による原価の変動に対応できますか？**
A: はい、仕入れマスタで材料の単価を更新することで、新しい原価が自動的に反映されます。

---

### 在庫管理について

**Q: 在庫数が負の値になってしまったのですが？**
A: これは誤った出庫記録が原因です。編集履歴で該当の記録を修正してください。

**Q: 複数の倉庫・保管場所の在庫を管理できますか？**
A: はい、同じ材料でも保管場所ごとに別として登録することで管理可能です。例えば「小麦粉（冷蔵庫）」「小麦粉（常温倉庫）」のように区別します。

**Q: 賞味期限を管理できますか？**
A: 現在は標準機能にはありませんが、メモ欄に賞味期限を記入することで管理可能です。

**Q: 最小在庫量（リオーダーポイント）を設定できますか？**
A: はい、仕入れマスタで各材料の最小在庫量を設定できます。在庫がこれ以下になるとアラート表示されます。

---

### 仕込みカレンダー・発注について

**Q: 2割ルールの20%は変更できますか？**
A: はい、管理者設定から変更できます。右上メニュー → **`⚙️ システム設定`** で調整してください。

**Q: 複数の仕込み予定を1日に登録できますか？**
A: はい、可能です。1日に複数レシピの仕込み予定を登録でき、発注リストに自動統合されます。

**Q: 過去の発注実績から予測を立てられますか？**
A: はい、発注履歴タブでグラフ表示により、過去のパターンから傾向を分析できます。

**Q: 特定の材料を除いて発注リストを生成できますか？**
A: はい、発注リスト生成時に除外する材料をチェックボックスで選択できます。

---

### ユーザー管理・セキュリティについて

**Q: パスワードの複雑性に要件はありますか？**
A: Supabase Authのデフォルト設定に従い、8文字以上が推奨されています。

**Q: ユーザーのアクティビティログを見ることはできますか？**
A: 管理者画面で基本的なアクティビティ（ログイン/ログアウト）を確認できます。詳細なアクティビティログは技術ドキュメントを参照してください。

**Q: 複数ユーザーのパスワード一括リセットはできますか？**
A: いいえ、各ユーザーが個別にパスワード復旧メールから設定する必要があります。

**Q: ロールの権限を詳しく知りたいのですが？**
A: [技術ドキュメント](./TECHNICAL_DOCUMENTATION.md)の「認証とセキュリティ」セクションを参照してください。

---

### 技術・デプロイメントについて

**Q: このアプリを自分のサーバーでホストできますか？**
A: はい、本リポジトリをフォークして自分のサーバーにデプロイすることが可能です。詳細は [TECHNICAL_DOCUMENTATION.md](./TECHNICAL_DOCUMENTATION.md) を参照してください。

**Q: APIエンドポイントを外部アプリから呼び出せますか？**
A: はい、Supabase APIを使用して外部から呼び出し可能です。詳細は技術ドキュメントを参照してください。

**Q: データベースのバックアップ戦略は？**
A: Supabaseが自動でバックアップしており、24時間ごとのスナップショットが保存されます。

**Q: このアプリはどのブラウザで動作しますか？**
A: Chrome、Firefox、Safari、Edgeの最新バージョンで動作確認済みです。

---

## 📚 関連ドキュメント

- [技術ドキュメント](./TECHNICAL_DOCUMENTATION.md) - システムアーキテクチャ、API仕様、データベーススキーマ、デプロイメント手順など
- [操作マニュアル](./OPERATION_MANUAL.md) - 管理者向けの詳細な運用ガイド
- [FAQ・クイックスタート](./FAQ_QUICK_START.md) - よくある質問と初期セットアップ

---

## 🚀 サポート & 開発

### バグ報告・機能リクエスト

バグや機能改善のリクエストは、以下の方法でお知らせください：

1. **GitHub Issues**: [issues page](https://github.com/your-repo/issues)
2. **Email**: support@example.com

### 開発への協力

このプロジェクトはオープンソースです。改善提案やPull Requestを歓迎します。

1. リポジトリをフォーク
2. 機能ブランチを作成 (`git checkout -b feature/amazing-feature`)
3. 変更をコミット (`git commit -m 'Add amazing feature'`)
4. ブランチをプッシュ (`git push origin feature/amazing-feature`)
5. Pull Requestを作成

---

## 📝 ライセンス

このプロジェクトはMITライセンスの下で公開されています。

---

## 📌 まとめ

このレシピ管理アプリは、飲食業の効率化を目指した包括的なツールです：

✅ **簡単なレシピ管理**: PC・スマートフォンで直感的に操作
✅ **正確な原価管理**: 自動計算で業務時間を削減
✅ **スマートな在庫管理**: リアルタイム追跡と差異検出
✅ **効率的な発注**: 自動計算で発注ミスを防止
✅ **強力なセキュリティ**: ロールベースのアクセス制御
✅ **継続的な改善**: パフォーマンス最適化を定期実施

詳細な使い方は、各セクションのマニュアルを参照してください。ご不明な点は、サポートまでお気軽にお問い合わせください。

---

**作成者**: MARUGO-s
**最終更新**: 2026年2月3日
**バージョン**: 2.0
