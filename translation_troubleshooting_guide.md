# 翻訳機能トラブルシューティングガイド

## 🚨 問題の状況
- 翻訳機能が動作しない
- エラーメッセージが表示される

## 🔍 翻訳機能の仕組み

### 使用技術
- **API**: call-groq-api Edge Function
- **翻訳モード**: recipe_translation
- **対象言語**: 英語、ドイツ語など
- **モデル**: Groq API (llama-3.1-8b-instant)

### 翻訳処理の流れ
1. レシピデータを取得
2. 翻訳プロンプトを作成
3. Groq APIを呼び出し
4. 翻訳結果を解析
5. 翻訳結果を表示

## 🔧 考えられる問題と解決方法

### 1. call-groq-api Edge Functionがデプロイされていない
**症状**: 404エラー
**確認方法**:
1. Supabase Dashboard にログイン
2. プロジェクト `nnbdzwrndqtsfzobknmj` を選択
3. Edge Functions セクションで `call-groq-api` を確認

**解決方法**:
- Edge Functionをデプロイする

### 2. GROQ_API_KEYが設定されていない
**症状**: 401/403エラー
**確認方法**:
1. Supabase Dashboard > Settings > Edge Functions
2. Secrets セクションで `GROQ_API_KEY` を確認

**解決方法**:
- GROQ_API_KEYを設定する

### 3. 翻訳モードの処理が正しく実装されていない
**症状**: 500エラー
**確認方法**:
- Supabase Dashboard でEdge Functionのログを確認

**解決方法**:
- Edge Functionのコードを確認・修正

### 4. レート制限エラー
**症状**: 429エラー
**確認方法**:
- ブラウザの開発者ツールでエラーメッセージを確認

**解決方法**:
- 待機時間を延長する

## 🎯 デバッグ手順

### Step 1: ブラウザの開発者ツールでエラー確認
1. F12で開発者ツールを開く
2. Console タブでエラーメッセージを確認
3. Network タブでリクエストの詳細を確認

### Step 2: 具体的なエラーメッセージを確認
**確認すべき情報**:
- ステータスコード (404, 500, 401, 403, 429など)
- エラーメッセージの詳細
- リクエストURL
- レスポンスの内容

### Step 3: Supabase Dashboard で確認
1. Edge Functions の状態
2. APIキーの設定状況
3. 実行ログの確認

## 🔍 翻訳機能のテスト方法

### 1. 基本的なテスト
1. レシピ編集画面を開く
2. 翻訳行を追加
3. 言語を選択（英語など）
4. 翻訳ボタンをクリック
5. 結果を確認

### 2. 詳細テスト
1. 開発者ツールを開く
2. Console タブでログを監視
3. Network タブでリクエストを監視
4. エラーが発生した場合の詳細を記録

## 📋 確認すべき項目

### 1. Supabase Dashboard確認
- [ ] プロジェクト `nnbdzwrndqtsfzobknmj` がアクティブ
- [ ] `call-groq-api` Edge Functionがデプロイ済み
- [ ] `GROQ_API_KEY` が設定済み

### 2. ブラウザ確認
- [ ] ハードリフレッシュ実行済み
- [ ] キャッシュクリア済み
- [ ] 開発者ツールでエラー確認済み

### 3. 翻訳機能確認
- [ ] 翻訳UIが表示される
- [ ] 言語選択ができる
- [ ] 翻訳ボタンがクリックできる

## 🚀 即座に試せる解決方法

### 1. ブラウザキャッシュクリア
```bash
Ctrl+Shift+R  # ハードリフレッシュ
```

### 2. 開発者ツールでエラー確認
1. F12で開発者ツールを開く
2. Console タブでエラーメッセージを確認
3. Network タブで失敗したリクエストを確認

### 3. 翻訳機能の再試行
1. ページを再読み込み
2. 翻訳機能を再度試行
3. エラーメッセージを確認

## 📞 次のステップ

### 問題が解決しない場合
1. 具体的なエラーメッセージを記録
2. ステータスコードを確認
3. リクエストURLを確認
4. レスポンス内容を確認

### 追加の改善案
1. エラーハンドリングの強化
2. より詳細なログ出力
3. ユーザーフレンドリーなエラーメッセージ
4. 自動リトライ機能

## 🎯 成功の確認

翻訳機能が正常に動作する場合:
- 翻訳UIが表示される
- 言語選択ができる
- 翻訳ボタンをクリックできる
- 翻訳結果が表示される
- エラーメッセージが表示されない

この状態になれば、翻訳機能は正常に動作しています。
